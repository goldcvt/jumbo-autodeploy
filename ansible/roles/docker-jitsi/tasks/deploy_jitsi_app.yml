---

- name: Replace docker-compose.yml
  copy:
    src: main-docker-compose.yml
    dest: "{{ jitsi_installation_folder }}/docker-jitsi-meet-stable-5390-1/docker-compose.yml"
  
- name: Replace .env
  template:
    src: main.env.j2
    dest: "{{ jitsi_installation_folder }}/docker-jitsi-meet-stable-5390-1/.env"

- name: Replace 10-conf
  template:
    src: 10-config.j2
    dest: "{{ jitsi_installation_folder }}/docker-jitsi-meet-stable-5390-1/prosody/rootfs/etc/cont-init.d/10-config"

- name: Run jitsi-app containers via docker-compose
  command: docker-compose --project-directory {{ jitsi_installation_folder }}/docker-jitsi-meet-stable-5390-1 --project-name -f {{ jitsi_installation_folder }}/docker-jitsi-meet-stable-5390-1/docker-compose.yml jitsi up -d
  #docker_compose:
  #  recreate: smart
  #  project_src:  "{{ jitsi_installation_folder }}/docker-jitsi-meet-stable-5390-1"
  #  files: docker-compose.yml
